# Config Hub - Implementation Roadmap

## Vision Summary

**Config Hub is an ArgoCD-driven GitOps UI** where:
- ArgoCD ApplicationSets are the source of truth
- Resources (Git, Vault) are contextual, not hidden in settings
- All changes flow through Pull Requests
- Three unified workflows: Config, Secrets, External Secrets

---

## âœ… Completed (Current Session)

### Foundation
- [x] Bitbucket Cloud full implementation (files, branches, commits, PRs, diff, approve, merge)
- [x] App rename: electron-react-app â†’ config-hub
- [x] Credential migration utility (auto-migrate on startup)
- [x] Removed blocking dialogs (confirm/alert â†’ AlertDialog)
- [x] Provider type detection (Bitbucket Server vs Cloud, GitHub, GitLab)
- [x] Environment filtering (credentials without env show in all envs)
- [x] Fixed Bitbucket Server URL format
- [x] Design documents for unified configuration

### Current State
- Git operations work for both Bitbucket Server and Cloud
- PR workflow complete (create, view, diff, approve, merge)
- Settings page has Git, ArgoCD, Vault, Helm configuration
- Basic ArgoCD application detail view exists

---

## ðŸŽ¯ Next Phase: Contextual Resources

### Phase 1: Inline Resource Management
**Goal:** Show Git/Vault status directly in application detail, not hidden in settings

#### 1.1 Resource Status Cards
```typescript
// New component: ResourceStatusCard
<ResourceStatusCard
  type="git"
  status="connected" | "not-configured" | "error"
  resource={gitCredential}
  onConfigure={() => showInlineConfig()}
  onTest={() => testConnection()}
/>
```

**Tasks:**
- [ ] Create `ResourceStatusCard` component
- [ ] Add to ArgoCD application detail view
- [ ] Show Git repository status
- [ ] Show Vault connection status
- [ ] Add quick actions (configure, test, refresh)

#### 1.2 Inline Configuration Dialogs
```typescript
// New component: InlineGitConfig
<Dialog>
  <DialogContent>
    <InlineGitConfig
      repoUrl={autoDetectedFromArgoCD}
      onSave={(credential) => linkAndContinue()}
    />
  </DialogContent>
</Dialog>
```

**Tasks:**
- [ ] Create `InlineGitConfig` dialog
- [ ] Create `InlineVaultConfig` dialog
- [ ] Pre-fill from ArgoCD app spec
- [ ] Test connection before save
- [ ] Auto-link to application

#### 1.3 Smart Detection
**Tasks:**
- [ ] Detect missing Git credentials when viewing app
- [ ] Show inline prompt to configure
- [ ] Extract repo URL from ArgoCD app spec
- [ ] Suggest credential name based on app

---

### Phase 2: Auto-Discovery from ArgoCD

#### 2.1 Git Source Discovery
**Tasks:**
- [ ] Parse ArgoCD app spec for Git sources
- [ ] Handle single source (legacy)
- [ ] Handle multi-source (new)
- [ ] Extract repo URL, branch, path

#### 2.2 Credential Matching
**Tasks:**
- [ ] Find existing credentials by repo URL
- [ ] Match base URL for Bitbucket Server
- [ ] Suggest creating new credential if none found
- [ ] Auto-link when match is found

#### 2.3 ApplicationSet Support
**Tasks:**
- [ ] Detect apps generated by ApplicationSets
- [ ] Group related apps
- [ ] Share credentials across app family

---

### Phase 3: Unified Workflows

#### 3.1 Config Editing Flow
**Tasks:**
- [ ] Browse config files from Git
- [ ] YAML editor with validation
- [ ] Preview changes (diff)
- [ ] Auto-generate PR description
- [ ] Create PR with one click

#### 3.2 Secrets Management Flow
**Tasks:**
- [ ] Discover secrets in application
- [ ] Detect secret type (K8s, Sealed, SOPS, External)
- [ ] Secret editor UI
- [ ] Encryption support (Sealed Secrets, SOPS)
- [ ] Create PR with encrypted secrets

#### 3.3 External Secrets + Vault Flow
**Tasks:**
- [ ] Vault connection management
- [ ] Browse Vault paths
- [ ] Secret mapping UI (Vault key â†’ K8s key)
- [ ] Generate External Secret manifest
- [ ] Dual operation: Store in Vault + Create PR

---

### Phase 4: Simplified Settings

#### 4.1 Minimal Settings Page
**Tasks:**
- [ ] Move to appearance/notifications only
- [ ] Remove Git/Vault/ArgoCD tabs
- [ ] Add "View All Credentials" link (advanced)
- [ ] Keep as fallback for power users

#### 4.2 Resource Library (Optional)
**Tasks:**
- [ ] Separate page for all credentials
- [ ] Organized by type and environment
- [ ] Bulk operations (test all, delete unused)
- [ ] Only accessible from settings

---

## ðŸš€ Future Enhancements

### Multi-Tenancy
- [ ] Support multiple ArgoCD servers
- [ ] Environment-based isolation
- [ ] Team-based access control

### Advanced Git Operations
- [ ] Merge conflict resolution
- [ ] Rebase support
- [ ] Cherry-pick commits
- [ ] Branch protection rules

### Secrets Management
- [ ] Secret rotation workflows
- [ ] Audit trail for secret changes
- [ ] Secret scanning/validation
- [ ] Integration with secret managers (AWS Secrets Manager, Azure Key Vault)

### Collaboration
- [ ] PR review workflow
- [ ] Comments and discussions
- [ ] Approval policies
- [ ] Notifications (Slack, Teams, Email)

### Observability
- [ ] Sync status dashboard
- [ ] Deployment history
- [ ] Rollback capabilities
- [ ] Metrics and analytics

---

## Success Metrics

### User Experience
- **Zero Settings Navigation**: Users never need to visit settings for normal workflows
- **PR Creation Time**: < 5 clicks from edit to PR
- **Auto-Configuration**: 80%+ of Git credentials auto-configured from ArgoCD

### Technical
- **Test Coverage**: > 80% for core workflows
- **Performance**: < 2s to load application detail
- **Reliability**: 99.9% uptime for Git operations

### Adoption
- **Active Users**: Track daily active users
- **PR Volume**: Number of PRs created through Config Hub
- **Time Saved**: Measure vs manual Git operations

---

## Development Principles

1. **ArgoCD First**: Always start from ArgoCD as source of truth
2. **Context Over Settings**: Show resources where they're needed
3. **PR Everything**: All changes must go through Pull Requests
4. **Progressive Enhancement**: Build incrementally, ship often
5. **User Feedback**: Iterate based on real usage

---

## Next Session Goals

1. âœ… Commit current work
2. ðŸŽ¯ Implement `ResourceStatusCard` component
3. ðŸŽ¯ Add inline Git configuration dialog
4. ðŸŽ¯ Show Git status in ArgoCD application detail
5. ðŸŽ¯ Test end-to-end flow: View app â†’ Configure Git â†’ Browse files

---

## Notes

- Keep settings page as fallback during transition
- Maintain backward compatibility with existing configs
- Document migration path for users
- Consider feature flags for gradual rollout

---

**Last Updated:** 2025-10-06
**Status:** Ready to implement Phase 1
